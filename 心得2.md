## [第五空间 2021]WebFTP
### 思路和解题：
- ai：在CTF（Capture The Flag）比赛中，`phpinfo`文件（通常为`phpinfo.php`）是一个包含`phpinfo()`函数输出的脚本文件，用于展示当前PHP环境的详细配置信息。这类文件在CTF中通常作为**信息收集**的关键点，可能隐藏敏感信息或暴露服务器配置漏洞。以下是其常见用途及示例：

---

### **1. 敏感信息泄露**
   - **数据库凭据**：可能在`$_ENV`、`$_SERVER`或环境变量中泄露数据库账号密码。
   - **文件路径**：暴露绝对路径（如`SCRIPT_FILENAME`）、临时文件目录（`upload_tmp_dir`），帮助定位文件上传或包含漏洞。
   - **Flag直接隐藏**：有时Flag会直接写在PHP配置的某个变量中（如`$_SERVER['FLAG']`）。

---

### **2. 危险配置检测**
   - **危险函数启用**：检查`disable_functions`是否未禁用`exec`、`system`、`passthru`等函数，可能允许RCE（远程代码执行）。
   - **文件操作权限**：`open_basedir`限制是否宽松，`allow_url_include`/`allow_url_fopen`是否开启（可能导致RFI/LFI漏洞）。
   - **扩展加载**：如启用`FFI`、`imagemagick`等扩展可能提供攻击面。

---

### **3. 漏洞利用线索**
   - **PHP版本漏洞**：低版本PHP可能存在已知漏洞（如PHP 7.x的`php://filter`链式利用）。
   - **临时文件竞争**：结合`upload_progress`或文件上传临时目录，实现竞争条件攻击。
   - **自定义配置**：非标准配置可能导致解析漏洞（如`.user.ini`文件绕过）。

---

### **4. 实际CTF题型示例**
   - **例题1**：题目给出`phpinfo.php`，要求通过`$_SERVER['DOCUMENT_ROOT']`找到Web根目录，结合文件包含读取`/flag`。
   - **例题2**：`phpinfo`中显示`mail()`函数可用，利用其创建临时文件写入Webshell。
   - **例题3**：`disable_functions`未禁用`imap_open`，利用其CVE-2018-19518漏洞绕过限制执行命令。

---

### **如何快速分析phpinfo**
1. **搜索关键词**：`disable_functions`、`open_basedir`、`allow_url_include`、`extension_dir`。
2. **检查环境变量**：查看`$_ENV`和`$_SERVER`部分。
3. **关注版本信息**：PHP版本、Web服务器版本（如Apache/Nginx）。

---

### **防御建议（对CTF出题者）**
- 清理敏感信息（如数据库密码）。
- 模拟真实安全配置（禁用危险函数、限制目录权限）。
- 将Flag隐藏在非明显位置（如反序列化数据、数据库）。

通过分析`phpinfo`，选手可以快速定位漏洞利用路径，是CTF Web方向中常见的信息收集突破口。

- 所以使用御剑扫描域名后发现phpinfo，打开搜索可以发现flag。